# Upstreams (localhost-only)
OLLAMA_BASE_URL=http://127.0.0.1:11434
MLX_BASE_URL=http://127.0.0.1:10240/v1

# Gateway listen
GATEWAY_HOST=0.0.0.0
GATEWAY_PORT=8800

# Auth (required). Generate a long random token.
GATEWAY_BEARER_TOKEN=682c0b0ea47eaf458d944df4853424a13012d61594d47200f3343cbdb341d461

# Routing policy
DEFAULT_BACKEND=ollama   # ollama|mlx
OLLAMA_MODEL_DEFAULT=qwen2.5:32b
MLX_MODEL_DEFAULT=mlx-community/gemma-2-2b-it-8bit

# Tooling (gateway-level)
TOOLS_ALLOW_SHELL=true
TOOLS_ALLOW_FS=true
TOOLS_SHELL_CWD=/var/lib/gateway/tools
TOOLS_SHELL_TIMEOUT_SEC=20

# Tool bus JSONL log
TOOLS_LOG_PATH=/var/lib/gateway/data/tools/invocations.jsonl

# Tool bus logging mode:
# - ndjson: append-only JSONL at TOOLS_LOG_PATH
# - per_invocation: one JSON file per replay_id under TOOLS_LOG_DIR
# - both: do both
TOOLS_LOG_MODE=ndjson
TOOLS_LOG_DIR=/var/lib/gateway/data/tools

# Optional: explicit tool registry (versioned tool declarations executed via subprocess).
# See services/gateway/env/tools_registry.json.example
TOOLS_REGISTRY_PATH=/var/lib/gateway/app/tools_registry.json

# Optional: registry integrity check (sha256 hex). If set and mismatched, registry is ignored.
TOOLS_REGISTRY_SHA256=

# Tool execution hard limits
TOOLS_MAX_CONCURRENT=8
TOOLS_CONCURRENCY_TIMEOUT_SEC=5
TOOLS_SUBPROCESS_STDOUT_MAX_CHARS=20000
TOOLS_SUBPROCESS_STDERR_MAX_CHARS=20000

# Optional: per-bearer-token rate limiting for /v1/tools endpoints (disabled when <= 0).
TOOLS_RATE_LIMIT_RPS=0
TOOLS_RATE_LIMIT_BURST=0

# Optional: metrics endpoint
METRICS_ENABLED=true

# Embeddings
EMBEDDINGS_BACKEND=ollama   # ollama|mlx
EMBEDDINGS_MODEL=nomic-embed-text

# Memory
MEMORY_ENABLED=true
MEMORY_DB_PATH=/var/lib/gateway/data/memory.sqlite
MEMORY_TOP_K=6
MEMORY_MIN_SIM=0.25
MEMORY_MAX_CHARS=6000

# Minimal request instrumentation (JSONL)
REQUEST_LOG_ENABLED=true
REQUEST_LOG_PATH=/var/lib/gateway/data/requests.jsonl

